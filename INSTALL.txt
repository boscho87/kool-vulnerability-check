******************************************
* INSTALLATION OF KOOL - THE CHURCH TOOL *
******************************************


INTRODUCTION
============

As you have downloaded this package you seem to already know about kOOL - the church tool.
If not, just visit https://www.churchtool.org where you'll find a lot of information about kOOL.

This short guide is meant to get you started with kOOL.



REQUIREMENTS
============

Webserver
---------
You will mainly need a webserver with Apache, PHP and MySQL or similar.
Everything should also run on a windows server but is not officially supported.

Magic Quotes GPC
----------------
magic_quotes_gpc must be disabled in your php.ini in order for kOOL to work properly.

Smarty template enginge
-----------------------
The rendering of HTML in kOOL is done through the template engine smarty from https://www.smarty.net. Make sure to use version 2.
It is easiest to download and unpack smarty and then point $INCLUDE_PATH_SMARTY in your config/ko-config.php file to the libs path.



NEWBIE INFORMATION ABOUT THE KOOL FILESYSTEM STRUCTURE
======================================================

kOOL consits of these two parts
  1. The kOOL source
  2. The kOOL web directory

Only files that are specific to your kOOL installation will be stored in the web directory, the core stays in it's own directory.
A typical directory structure will look like this:

/path/to/kOOL/src           : kOOL source directory
/path/to/kOOL/web           : The web root of a virtual host
   |
	 --> /kOOL_lib            : A symlink to the kOOL source directory (../src)

Most of the other files and directories in the web folder will be links to kOOL_lib. So you only have to change this one symlink if you plan to use another source directory for a kOOL installation, e.g. when updating to a newer version.



INSTALLATION STEP BY STEP
=========================

The first time
--------------
1. Get the kOOL source package from https://www.churchtool.org

2. Copy the source package into a directory
   # cp kOOL_<version>.zip .
	 and unpack it
   # unzip kOOL_<version>.zip

3. Install composer packages
   # composer install --no-dev

4. Create the web directory for your kOOL installation
   # mkdir web

5. Copy the installation script into the webfolder
   # cp src/install/kOOL_setup.sh web
	 Adapt the settings at the top of this script if needed and run it
	 (Important: Make sure to run this script from inside the web directory)
   # cd web
   # bash ./kOOL_setup.sh

6. Create an empty database and a MySQL user with access to this database

7. Make your web directory accessible through your apache configuration and start the web based installation:
   http://<your.kool.server>/install



Scheduler
---------
In order to let your kOOL installation run tasks periodically like processing mails or sending reminders, you have to add a cronjob which runs the script scheduler.php every few minutes, like so:
*/5 * * * * /usr/bin/php /path/to/kOOL/web/scheduler.php


Mail transport
--------------
You should configure the mail transport in config/ko-config.php to use an SMTP account. This will be used for sending automated emails.



UPDATE AN EXISTING KOOL INSTALLATION
====================================

1. Download the new source package of kOOL and unpack it into your source directory

2. Run the install script (src/install/kOOL_setup.sh) in all your kOOL web directories (adapt settings in file first)

3. Check and update your database by calling php install/update.phpsh

(4. Follow any additional instructions on https://www.churchtool.org for this release of kOOL)

5. You may want to check for new settings in install/default/config/ko-config.php and merge them back into your ko-config.php




OPTIONAL ADDITIONAL INSTALLATION STEPS
======================================

To get the maximum out of your kOOL you need to have access to an LDAP server and be able to install WebDAV on your webserver.
It is beyond the scope of this short installation instruction to give you the details about these technologies, but below you will find some hints


Mailaccount for mailings
------------------------
In order to use the mailing module, you'll need an email domain with one single catch all account. Usually you would want to use your kOOL domain as an email account, e.g. kool.domain.tld. Just create one single email account (e.g. kOOL@kool.domain.tld) and configure it as a catch all account so all emails to *@kool.domain.tld will arrive in this account. Fill out $MAILING_PARAMETER in your config/ko-config.php with the settings for this email catch all account.

For the mailing script to be able to access the POP3 account, your PHP must be configured with the imap extension.



---------------------------------------
(c) Renzo Lauper <renzo@churchtool.org>

Last changes: 2020-02-03
